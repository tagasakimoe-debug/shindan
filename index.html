<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>あなたに合った働き方診断</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Simple fade-in animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen font-sans py-10">

    <div id="app" class="w-full max-w-2xl mx-auto bg-white rounded-xl shadow-lg p-6 md:p-10 text-gray-800">

        <!-- Header -->
        <header class="text-center border-b pb-4 mb-6">
            <h1 class="text-2xl md:text-3xl font-bold text-indigo-600">あなたに合った働き方診断</h1>
            <p class="text-gray-500 mt-2">10の質問に答えて、あなたの強みを見つけよう！</p>
        </header>

        <!-- Question Area -->
        <div id="question-container">
            <div id="question-card" class="fade-in">
                 <p id="question-number" class="text-indigo-500 font-semibold mb-2">質問 1</p>
                <h2 id="question-text" class="text-xl font-bold mb-6"></h2>
                <div id="options-container" class="grid grid-cols-1 gap-4">
                    <!-- Options will be inserted here by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Result Area -->
        <div id="result-container" class="hidden text-center fade-in">
            <h2 class="text-2xl font-bold text-indigo-600 mb-4">診断結果</h2>
            <div id="result-content" class="bg-indigo-50 p-6 rounded-lg">
                <p class="text-lg font-semibold mb-2">あなたの適性 TOP3</p>
                <div id="recommended-courses" class="mt-4"></div>
                <p id="result-message" class="text-gray-600 mt-6"></p>
            </div>
             <button id="restart-button" class="mt-8 bg-indigo-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-indigo-700 transition-colors duration-300">
                もう一度診断する
            </button>
        </div>
    </div>

    <!-- The core JavaScript logic is now inside the HTML file -->
    <script>
        // --- Diagnosis Data (Algorithm updated based on user request) ---
        const diagnosisData = {
          "questions": [
            { "id": 1, "question": "プロジェクトが始まる時、あなたが最も得意なのは？", "options": [
                { "id": "a", "text": "プロジェクトの目的を、みんなが分かるように言葉でまとめること。" },
                { "id": "b", "text": "世の中の流行にアンテナを張り、多くの人が面白がる「話題」を考えること。" },
                { "id": "c", "text": "このプロジェクトが「誰のためになるか」を考え、それを届けるための計画を立てること。" },
                { "id": "d", "text": "プロジェクトの「見た目」や「使いやすさ」の、全体のイメージを考えること。" },
                { "id": "e", "text": "プロジェクトの面白さが伝わるように、感動的な「ストーリーの流れ」を考えること。" },
                { "id": "f", "text": "プロジェクトの「土台となる仕組み」を考え、問題なく動くように設計すること。" }
            ]},
            { "id": 2, "question": "あなたが「良い仕事をした」と最も満足感を得られるのは、どんな時ですか？", "options": [
                { "id": "a", "text": "自分の書いた文章で、言いたいことが相手に正確に伝わった時。" },
                { "id": "b", "text": "自分の投稿がきっかけで、たくさんの人が盛り上がっているのを見た時。" },
                { "id": "c", "text": "自分の作ったものが売れて、誰かの役に立ったと実感した時。" },
                { "id": "d", "text": "自分がデザインしたものが「キレイ」「使いやすい」と褒められた時。" },
                { "id": "e", "text": "自分が作った作品で、誰かが感動したり笑ったりしてくれた時。" },
                { "id": "f", "text": "自分が作った「仕組み」が、裏側で完璧に動き続けていると知った時。" }
            ]},
            { "id": 3, "question": "地道で細かい作業に、長時間集中するのは得意ですか？", "options": [
                { "id": "a", "text": "好き。一つのことに没頭して、完璧に仕上げるのが楽しい。" },
                { "id": "b", "text": "得意。間違いがないように、細かい部分までチェックするのは苦にならない。" },
                { "id": "c", "text": "どちらかと言えば、全体を考えたり、人と話す方が好き。" },
                { "id": "d", "text": "苦手。色々な刺激がある方が、やる気が出る。" }
            ]},
            { "id": 4, "question": "あなたの「こだわり」が最も強く発揮されるのは、どんな部分ですか？", "options": [
                { "id": "a", "text": "言葉の選び方。しっくりくる表現が見つかるまで、とことん考える。" },
                { "id": "b", "text": "人々の反応。どうすればもっと「いいね」と思ってもらえるか、常に考える。" },
                { "id": "c", "text": "目に見える成果。目標を達成するためなら、何度でもやり方を変えて挑戦する。" },
                { "id": "d", "text": "全体のバランス。少しのズレでも気になるので、完璧に整えたい。" },
                { "id": "e", "text": "テンポやリズム感。一瞬の間が、全体の雰囲気を決めると考える。" },
                { "id": "f", "text": "仕組みの正しさ。小さな間違いが、後で大きな問題になるので見逃せない。" }
            ]},
            { "id": 5, "question": "何かを学ぶとき、あなたが最も心地よいと感じる方法は？", "options": [
                { "id": "a", "text": "本などをたくさん読んで、自分なりに知識を整理し直す。" },
                { "id": "b", "text": "色々な人の意見や最新ニュースに触れて、世の中の流れから学ぶ。" },
                { "id": "c", "text": "成功している人のやり方を真似て、試しながら覚える。" },
                { "id": "d", "text": "素敵なものをたくさん見て、なぜ良いのかを自分なりに分析する。" },
                { "id": "e", "text": "好きな作品に何度も触れて、その良さを感覚で掴み取る。" },
                { "id": "f", "text": "まず基本ルールを理解して、そこから応用を考えていく。" }
            ]},
            { "id": 6, "question": "仕事で他人と協力する際、あなたの得意な役割は？", "options": [
                { "id": "a", "text": "会議の内容を、誰でも分かるように文章でまとめる。" },
                { "id": "b", "text": "チームの活動の楽しさを、外の人にアピールして仲間を増やす。" },
                { "id": "c", "text": "チームの頑張りを、売上などの「結果」に変えてみんなに報告する。" },
                { "id": "d", "text": "チームのふわっとしたアイデアを、魅力的で具体的な「完成イメージ」にする。" },
                { "id": "e", "text": "バラバラの材料から、一つの感動的な「ストーリー」を組み立てる。" },
                { "id": "f", "text": "チームのアイデアを、実際に「動く仕組み」として形にする。" }
            ]},
            { "id": 7, "question": "あなたが「無人島に一つだけ持っていけるもの」を選ぶなら？", "options": [
                { "id": "a", "text": "物語を書き残せる、たくさんの紙とペン。" },
                { "id": "b", "text": "誰かと繋がるかもしれない、手回し充電の通信機。" },
                { "id": "c", "text": "生き残るための方法が書かれた、実用的なマニュアル本。" },
                { "id": "d", "text": "美しい絵を描ける、最高級の画材セット。" },
                { "id": "e", "text": "大好きな物語を、何度でも見返せる再生プレイヤー。" },
                { "id": "f", "text": "色々なものを組み立てられる、精密な工具セット。" }
            ]},
            { "id": 8, "question": "あなたが最も「美しい」と感じるものは？", "options": [
                { "id": "a", "text": "無駄なく、的確な言葉だけで書かれた文章。" },
                { "id": "b", "text": "たった一つの発信から、共感の輪が広がっていく様子。" },
                { "id": "c", "text": "良いアイデアが、ビジネスとして成功していく仕組み。" },
                { "id": "d", "text": "色や形、配置のバランスが、完璧に整っているもの。" },
                { "id": "e", "text": "テンポの良い展開で、人の心をグッと掴むストーリー。" },
                { "id": "f", "text": "複雑な問題が、スッキリとした数式や法則で解ける瞬間。" }
            ]},
            { "id": 9, "question": "仕事で最も避けたいと思う状況は？", "options": [
                { "id": "a", "text": "言いたいことが誤解されて、相手を混乱させてしまうこと。" },
                { "id": "b", "text": "軽い気持ちで言ったことで、誰かを傷つけてしまうこと。" },
                { "id": "c", "text": "お客さんをがっかりさせて、信頼を失ってしまうこと。" },
                { "id": "d", "text": "使いにくいものを作って、相手をイライラさせてしまうこと。" },
                { "id": "e", "text": "作ったものが「退屈だ」と思われ、何も伝わらないこと。" },
                { "id": "f", "text": "自分の小さなミスで、全部が動かなくなってしまうこと。" }
            ]},
            { "id": 10, "question": "あなたの考え方に最も近いものは？", "options": [
                { "id": "a", "text": "物事の背景にある「なぜそうなったか」という物語を考える。" },
                { "id": "b", "text": "人々の気持ちや、その場の「空気」を敏感に読み取る。" },
                { "id": "c", "text": "常に「目的」を意識して、そこから逆算して「今やるべきこと」を考える。" },
                { "id": "d", "text": "全体のバランスを考えて、直感的に「心地よい」と感じる形を探す。" },
                { "id": "e", "text": "時間の流れを考えて、最高のタイミングで盛り上がるように組み立てる。" },
                { "id": "f", "text": "物事をパーツに分けて、それらがどう繋がっているかを論理的に考える。" }
            ]}
          ],
          "courses": [
            { "id": 1, "name": "ライター", "reason": "知的好奇心が旺盛で、情報を深く掘り下げて整理するのが得意なあなたに最適です。物事を分かりやすく伝えたり、物語を構築する能力が活かされます。" },
            { "id": 2, "name": "SNS運用者", "reason": "トレンドに敏感で、人とコミュニケーションを取るのが好きなあなたに合っています。共感力が高く、多くの人と良好な関係を築く才能が活かされます。" },
            { "id": 3, "name": "オウンドSNSでのコンテンツ販売", "reason": "自分の力でビジネスを動かしたいという、強い起業家精神を持つあなたに向いています。顧客のニーズを深く理解し、価値を提供することに喜びを感じるでしょう。" },
            { "id": 4, "name": "WEBデザイナー", "reason": "美しいものや、心地よい体験を創り出すことに情熱を注げるあなたにぴったりです。細部へのこだわりと、使う人の気持ちを考える力が強みになります。" },
            { "id": 5, "name": "動画編集者", "reason": "地道で細かい作業に集中でき、物事のテンポやリズム感を掴むのが得意なあなたに適しています。忍耐強く、一つの作品を完成させることに達成感を感じるでしょう。" },
            { "id": 6, "name": "エンジニア", "reason": "複雑な問題を論理的に分析し、仕組みを正しく組み立てることに長けているあなたに最適です。知的な探求心と、粘り強い問題解決能力が最大限に活かされます。" }
          ],
          "diagnosis_rules": [ { 
            "scoring_matrix": [
                { "q": 1, "opt": "a", "score": { "1": 3 } }, { "q": 1, "opt": "b", "score": { "2": 3 } }, { "q": 1, "opt": "c", "score": { "3": 3 } }, { "q": 1, "opt": "d", "score": { "4": 3 } }, { "q": 1, "opt": "e", "score": { "5": 3 } }, { "q": 1, "opt": "f", "score": { "6": 2 } },
                { "q": 2, "opt": "a", "score": { "1": 3 } }, { "q": 2, "opt": "b", "score": { "2": 3 } }, { "q": 2, "opt": "c", "score": { "3": 3 } }, { "q": 2, "opt": "d", "score": { "4": 3 } }, { "q": 2, "opt": "e", "score": { "5": 3 } }, { "q": 2, "opt": "f", "score": { "6": 2 } },
                { "q": 3, "opt": "a", "score": { "5": 3 } }, { "q": 3, "opt": "b", "score": { "6": 2 } }, { "q": 3, "opt": "c", "score": { "3": 3 } }, { "q": 3, "opt": "d", "score": { "2": 3 } },
                { "q": 4, "opt": "a", "score": { "1": 3 } }, { "q": 4, "opt": "b", "score": { "2": 3 } }, { "q": 4, "opt": "c", "score": { "3": 3 } }, { "q": 4, "opt": "d", "score": { "4": 3 } }, { "q": 4, "opt": "e", "score": { "5": 3 } }, { "q": 4, "opt": "f", "score": { "6": 2 } },
                { "q": 5, "opt": "a", "score": { "1": 3 } }, { "q": 5, "opt": "b", "score": { "2": 3 } }, { "q": 5, "opt": "c", "score": { "3": 3 } }, { "q": 5, "opt": "d", "score": { "4": 3 } }, { "q": 5, "opt": "e", "score": { "5": 3 } }, { "q": 5, "opt": "f", "score": { "6": 2 } },
                { "q": 6, "opt": "a", "score": { "1": 3 } }, { "q": 6, "opt": "b", "score": { "2": 3 } }, { "q": 6, "opt": "c", "score": { "3": 3 } }, { "q": 6, "opt": "d", "score": { "4": 3 } }, { "q": 6, "opt": "e", "score": { "5": 3 } }, { "q": 6, "opt": "f", "score": { "6": 2 } },
                { "q": 7, "opt": "a", "score": { "1": 3 } }, { "q": 7, "opt": "b", "score": { "2": 3 } }, { "q": 7, "opt": "c", "score": { "3": 3 } }, { "q": 7, "opt": "d", "score": { "4": 3 } }, { "q": 7, "opt": "e", "score": { "5": 3 } }, { "q": 7, "opt": "f", "score": { "6": 2 } },
                { "q": 8, "opt": "a", "score": { "1": 3 } }, { "q": 8, "opt": "b", "score": { "2": 3 } }, { "q": 8, "opt": "c", "score": { "3": 3 } }, { "q": 8, "opt": "d", "score": { "4": 3 } }, { "q": 8, "opt": "e", "score": { "5": 3 } }, { "q": 8, "opt": "f", "score": { "6": 2 } },
                { "q": 9, "opt": "a", "score": { "1": 3 } }, { "q": 9, "opt": "b", "score": { "2": 3 } }, { "q": 9, "opt": "c", "score": { "3": 3 } }, { "q": 9, "opt": "d", "score": { "4": 3 } }, { "q": 9, "opt": "e", "score": { "5": 3 } }, { "q": 9, "opt": "f", "score": { "6": 2 } },
                { "q": 10, "opt": "a", "score": { "1": 3 } }, { "q": 10, "opt": "b", "score": { "2": 3 } }, { "q": 10, "opt": "c", "score": { "3": 3 } }, { "q": 10, "opt": "d", "score": { "4": 3 } }, { "q": 10, "opt": "e", "score": { "5": 3 } }, { "q": 10, "opt": "f", "score": { "6": 2 } }
            ]
          } ]
        };

        // --- DOM Elements ---
        const questionContainer = document.getElementById('question-container');
        const questionCard = document.getElementById('question-card');
        const questionNumberEl = document.getElementById('question-number');
        const questionTextEl = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const resultContainer = document.getElementById('result-container');
        const recommendedCoursesEl = document.getElementById('recommended-courses');
        const resultMessageEl = document.getElementById('result-message');
        const restartButton = document.getElementById('restart-button');

        // --- State Variables ---
        let currentQuestionIndex = 0;
        const courseScores = {};

        // --- Functions ---

        /**
         * Initializes the scores for all courses to zero.
         */
        function initializeScores() {
            diagnosisData.courses.forEach(course => {
                courseScores[course.id] = 0;
            });
        }
        
        /**
         * Displays the final diagnosis result based on calculated scores.
         */
        function displayResult() {
            questionContainer.classList.add('hidden');
            resultContainer.classList.remove('hidden');
            resultContainer.classList.add('fade-in');

            const sortedScores = Object.entries(courseScores)
                .map(([id, score]) => ({ id: parseInt(id), score }))
                .sort((a, b) => b.score - a.score);

            const top3 = sortedScores.slice(0, 3);
            
            recommendedCoursesEl.innerHTML = '';
            
            const rankText = ['1位', '2位', '3位'];
            const rankColors = ['text-amber-500', 'text-slate-500', 'text-orange-600'];

            let displayedCount = 0;
            top3.forEach((result, index) => {
                const course = diagnosisData.courses.find(c => c.id === result.id);
                if (course && result.score > 0) {
                    displayedCount++;
                    const resultHTML = `
                        <div class="text-left ${displayedCount > 1 ? 'border-t border-gray-200 mt-5 pt-5' : ''}">
                            <p class="text-xl font-bold flex items-baseline">
                                <span class="text-lg font-extrabold ${rankColors[index]} mr-2">${rankText[index]}</span>
                                <span class="text-indigo-700">${course.name}</span>
                            </p>
                            <p class="text-gray-700 mt-2 pl-10">
                                <strong class="font-semibold">理由:</strong> ${course.reason}
                            </p>
                        </div>
                    `;
                    recommendedCoursesEl.innerHTML += resultHTML;
                }
            });

            if (displayedCount === 0) {
                recommendedCoursesEl.innerHTML = '<p class="text-gray-600 text-center">今回は明確な適性が見つかりませんでした。あなたは幅広い分野に興味を持つバランスの取れたタイプかもしれません。</p>';
            }

            resultMessageEl.textContent = "これらの特性を参考に、あなたの可能性を探ってみてください。";
        }


        /**
         * Handles the click event for an option button.
         * @param {number} questionId - The ID of the current question.
         * @param {string} optionId - The ID of the selected option.
         */
        function handleOptionClick(questionId, optionId) {
            const scoringRule = diagnosisData.diagnosis_rules[0].scoring_matrix.find(
                rule => rule.q === questionId && rule.opt === optionId
            );
            if (scoringRule) {
                for (const courseId in scoringRule.score) {
                    courseScores[courseId] += scoringRule.score[courseId];
                }
            }
            
            questionCard.classList.remove('fade-in');

            setTimeout(() => {
                // Reduced the number of questions to 10 for a quicker diagnosis
                if (currentQuestionIndex < diagnosisData.questions.length - 1) {
                    currentQuestionIndex++; 
                    displayQuestion(currentQuestionIndex);
                } else {
                    displayResult();
                }
            }, 300);
        }

        /**
         * Displays a question and its options on the screen.
         * @param {number} questionIndex - The index of the question to display.
         */
        function displayQuestion(questionIndex) {
            const question = diagnosisData.questions[questionIndex];
            if (!question) return;

            questionTextEl.textContent = question.question;
            questionNumberEl.textContent = `質問 ${questionIndex + 1}`;
            optionsContainer.innerHTML = '';

            question.options.forEach(option => {
                const button = document.createElement('button');
                button.className = "w-full text-left bg-gray-100 p-4 rounded-lg hover:bg-indigo-100 hover:ring-2 hover:ring-indigo-300 transition-all duration-200";
                button.textContent = option.text;
                button.onclick = () => handleOptionClick(question.id, option.id);
                optionsContainer.appendChild(button);
            });
            
            questionCard.classList.add('fade-in');
        }

        /**
         * Resets the state and starts the diagnosis from the beginning.
         */
        function startDiagnosis() {
            currentQuestionIndex = 0;
            initializeScores();

            resultContainer.classList.add('hidden');
            questionContainer.classList.remove('hidden');

            displayQuestion(currentQuestionIndex);
        }

        // --- Event Listeners ---
        restartButton.addEventListener('click', startDiagnosis);

        // --- Initial Execution ---
        document.addEventListener('DOMContentLoaded', startDiagnosis);
    </script>
</body>
</html>

